---
- name: Set directory permissions for release_drupal_path
  file:
    path: "{{ ansistrano_current_dir }}"
    mode: "0755"
    state: directory
    recurse: yes
  tags:
    - pre-deploy

- name: Set directory permissions for ansistrano_shared_path
  file:
    path: "{{ ansistrano_release_path.stdout }}/web/sites/default/files"
    mode: "0755"
    state: directory
    owner: "{{ vault_server_client }}"
    group: "{{ vault_server_group }}"
    recurse: true

- name: Ensure properly permissions to vendor's directory
  file:
    path: "{{ ansistrano_release_path.stdout }}/vendor"
    mode: "0755"
    state: directory
    owner: "{{ vault_server_client }}"
    group: "{{ vault_server_group }}"
    recurse: true

- name: Ensure properly permissions to Drupal's root directory
  file:
    path: "{{ ansistrano_release_path.stdout }}/web"
    mode: "0755"
    state: directory
    owner: "{{ vault_server_client }}"
    group: "{{ vault_server_group }}"
    recurse: false

- name: Ensure properly permissions to Drupal's sites directory
  file:
    path: "{{ ansistrano_release_path.stdout }}/web/sites"
    mode: "0755"
    state: directory
    owner: "{{ vault_server_client }}"
    group: "{{ vault_server_group }}"
    recurse: false

- name: Ensure properly permissions to Drupal's sites/default directory
  file:
    path: "{{ ansistrano_release_path.stdout }}/web/sites/default"
    mode: "0755"
    state: directory
    owner: "{{ vault_server_client }}"
    group: "{{ vault_server_group }}"
    recurse: false

- name: Ensure properly permissions to Drupal's sites/default directory
  file:
    path: "{{ ansistrano_release_path.stdout }}/web/core"
    mode: "0755"
    state: directory
    owner: "{{ vault_server_client }}"
    group: "{{ vault_server_group }}"
    recurse: false
